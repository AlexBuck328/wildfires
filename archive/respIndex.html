<!DOCTYPE html>
<html>

<head>

    <meta charset='utf-8' />
    <title>RESP
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.css' rel='stylesheet' />
    <!--    <link href='https://api.mapbox.com/mapbox-assembly/v1.0.0/assembly.min.css' rel='stylesheet'>   -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Helvetica Neue', Helvetica, Arial, Sans-serif;
        }

        #map {
            position: absolute;
            z-index: -10;
            top: 0;
            bottom: 0;
            width: 100%;
        }

        h1 {
            font-size: 20px;
            line-height: 30px;
        }

        h2 {
            font-size: 14px;
            line-height: 20px;
            margin-bottom: 10px;
        }

        a {
            text-decoration: none;
            color: #feb24c;
        }

        a.disabled {
            pointer-events: none;
        }

        a:hover {
            text-decoration: underline;
            font-style: italic;
        }

        #console {
            position: absolute;
            display: grid;
            /* grid-template-columns: 1fr 1fr 1fr; */
            /* grid-template-rows: 50px 50px; */
            width: 31%;
            /* 520px; */
            height: 40%;
            bottom: 0;
            left: 0;
            margin: 10px;
            padding: 10px 20px;
            background-color: white;
        }

        .session {
            margin-bottom: 20px;
        }

        .row {
            height: 12px;
            width: 100%;
        }

        .colors {
            background: linear-gradient(to right, #ffffcc, #ffeda0, #feb24c, #fc4e2a, #b10026);
            margin-bottom: 5px;
        }

        .label {
            /* font-size: 10%;  */
            width: 15%;
            display: inline-block;
            text-align: center;
        }

        /* POLYS CSS */

        .dropdown-menu {
            max-height: 200px;
            overflow-y: auto;
        }

        .map-overlay {
            font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
            position: absolute;
            width: 25%;
            bottom: 0;
            right: 0;
            padding: 10px;
            z-index: 1;
        }

        .map-overlay .map-overlay-inner {
            background-color: #fff;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            border-radius: 3px;
            padding: 10px;
            margin-bottom: 10px;
        }

        .map-overlay h4 {
            line-height: 24px;
            display: block;
            margin: 0 0 10px;
        }

        .map-overlay .legend .bar {
            height: 10px;
            width: 100%;
            background: linear-gradient(to right, #fca107, #7f3121);
        }

        .map-overlay input {
            background-color: transparent;
            display: inline-block;
            width: 100%;
            position: relative;
            margin: 0;
            cursor: ew-resize;
        }

        .map-overlay-year {
            font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
            position: absolute;
            width: 25%;
            bottom: 0;
            left: 0;
            padding: 10px;
            z-index: 1;
        }

        .map-overlay-year .map-overlay-inner-year {
            background-color: #fff;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            border-radius: 3px;
            padding: 10px;
            margin-bottom: 10px;
        }

        .map-overlay-year h4 {
            line-height: 24px;
            display: block;
            margin: 0 0 10px;
        }

        .map-overlay-year .legend .bar {
            height: 10px;
            width: 100%;
            background: linear-gradient(to right, #fca107, #7f3121);
        }

        .map-overlay-year input {
            background-color: transparent;
            display: inline-block;
            width: 100%;
            position: relative;
            margin: 0;
            cursor: ew-resize;
        }

        #infoModal {
            position: absolute;
            /*top: 10px;
            right: 100px; */
            bottom: 0;
            right: 0;
            z-index: 10040;
            overflow: auto;
            overflow-y: auto;
        }

        #orange {
            color:#fca107;
        }


        @media screen and (max-width: 600px) {
            h4 {
                font-size: 14px;
            }
        }
    </style>
</head>

<body>
    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <span class="orange navbar-brand mb-0 h1" id="orange">Patterns of Destruction</span>
        </div>

    <!--   <a class="navbar-brand" href="#">Patterns of Destruction</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button> -->

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" href="https://github.com/AlexBuck328/wildfires" target="blank">About</a>
                </li>

                <!--    <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select Fire Year
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <a class="dropdown-item" href="#">1976</a>
                        <a class="dropdown-item" href="#">1977</a>
                        <a class="dropdown-item" href="#">1978</a>
                        <a class="dropdown-item" href="#">1979</a>
                        <a class="dropdown-item" href="#">1980</a>
                        <a class="dropdown-item" href="#">1981</a>
                        <a class="dropdown-item" href="#">1982</a>
                        <a class="dropdown-item" href="#">1983</a>
                        <a class="dropdown-item" href="#">1984</a>
                        <a class="dropdown-item" href="#">1985</a>
                        <a class="dropdown-item" href="#">1986</a>
                        <a class="dropdown-item" href="#">1987</a>
                        <a class="dropdown-item" href="#">1988</a>
                        <a class="dropdown-item" href="#">1989</a>
                        <a class="dropdown-item" href="#">1990</a>
                        <a class="dropdown-item" href="#">1991</a>
                        <a class="dropdown-item" href="#">1992</a>
                        <a class="dropdown-item" href="#">1993</a>
                        <a class="dropdown-item" href="#">1994</a>
                        <a class="dropdown-item" href="#">1995</a>
                        <a class="dropdown-item" href="#">1996</a>
                        <a class="dropdown-item" href="#">1997</a>
                        <a class="dropdown-item" href="#">1998</a>
                        <a class="dropdown-item" href="#">1999</a>
                        <a class="dropdown-item" href="#">2000</a>
                        <a class="dropdown-item" href="#">2001</a>
                        <a class="dropdown-item" href="#">2002</a>
                        <a class="dropdown-item" href="#">2003</a>
                        <a class="dropdown-item" href="#">2004</a>
                        <a class="dropdown-item" href="#">2005</a>
                        <a class="dropdown-item" href="#">2006</a>
                        <a class="dropdown-item" href="#">2007</a>
                        <a class="dropdown-item" href="#">2008</a>
                        <a class="dropdown-item" href="#">2009</a>
                        <a class="dropdown-item" href="#">2010</a>
                        <a class="dropdown-item" href="#">2011</a>
                        <a class="dropdown-item" href="#">2012</a>
                        <a class="dropdown-item" href="#">2013</a>
                        <a class="dropdown-item" href="#">2014</a>
                        <a class="dropdown-item" href="#">2015</a>
                        <a class="dropdown-item" href="#">2016</a>
                        <a class="dropdown-item" href="#">2017</a>
                        <a class="dropdown-item" href="#">2018</a>
                        <a class="dropdown-item" href="#">2019</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">Something else here</a>
                    </div>
            </ul> -->
        </div>






        <!--    <form class="float-right form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="search" placeholder="Enter Fire Year" aria-label="Search"
                    id='input'>
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit" id='myBtn'>Search</button>
            </form>
        </div> -->

        <!-- Button trigger modal -->
    <!--    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
            Launch demo modal
        </button> -->

        <!-- Modal -->
     <!--   <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        ...
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div> -->


    </nav>




    <div id='map'></div>

    <div id='console'>
    <!--    <h1>Patterns of Destruction</h1>
        <p>Data: <a href='https://www.sciencebase.gov/catalog/item/5ee13de982ce3bd58d7be7e7'>Combined wildfire
                datasets
                for the United States and certain territories, 1878-2019</a></p> -->
        <div class='session'>
            <h1>Acreage</h1>
            <div class='row colors'>
            </div>
            <div class='row labels'>
                <div class='label'>150</div>
                <div class='label'>750</div>
                <div class='label'>1000</div>
                <div class='label'>50000</div>
                <div class='label'>75000</div>
                <div class='label'>300000</div>
            </div>
        </div>
        <div class='session' id='sliderbar'>
            <h1>Year: <label id='active-year'>2019</label></h1>
            <input id='slider' class='row' type='range' min='0' max='43' step='1' value='43' />
        </div>
        <div class='session'>
            <h1>Month of year</h1>
            <div class='row' id='filters'>
                <input id='all' type='radio' name='toggle' value='all' checked='checked'>
                <label for='all'>All</label>
                <input id='January' type='radio' name='toggle' value='January'>
                <label for='January'>January</label>
                <input id='February' type='radio' name='toggle' value='February'>
                <label for='February'>February</label>
                <input id='March' type='radio' name='toggle' value='March'>
                <label for='March'>March</label>
                <input id='April' type='radio' name='toggle' value='April'>
                <label for='April'>April</label>
                <input id='May' type='radio' name='toggle' value='May'>
                <label for='May'>May</label>
                <input id='June' type='radio' name='toggle' value='June'>
                <label for='June'>June</label>
                <input id='July' type='radio' name='toggle' value='July'>
                <label for='July'>July</label>
                <input id='August' type='radio' name='toggle' value='August'>
                <label for='August'>August</label>
                <input id='September' type='radio' name='toggle' value='September'>
                <label for='September'>September</label>
                <input id='October' type='radio' name='toggle' value='October'>
                <label for='October'>October</label>
                <input id='November' type='radio' name='toggle' value='November'>
                <label for='November'>November</label>
                <input id='December' type='radio' name='toggle' value='December'>
                <label for='December'>December</label>
            </div>
        </div>
    </div>



</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
<script src="https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous">
</script>
<!-- <script async defer src='https://api.mapbox.com/mapbox-assembly/v1.0.0/assembly.js'></script>  -->
<script src='https://api.mapbox.com/mapbox-gl-js/v2.2.0/mapbox-gl.js'></script>
<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<script>
    // Access Token
    mapboxgl.accessToken =
        'pk.eyJ1IjoiYWxleGJ1Y2szMjgiLCJhIjoiY2szcDZsdmFsMW9rbDNubjMydm9rNGJpMyJ9.05szss9EHEoVBbGYajbPZA';

    // Map!!!
    var map = new mapboxgl.Map({
        container: 'map', // container element id
        style: 'mapbox://styles/mapbox/dark-v10',
        center: [-118.3527, 40.7815], // initial map center in [lon, lat]
        zoom: 4.66
    });

    map.on('load', function () {
        var filterYear = ['==', ['number', ['get', 'year']], 2019];
        var filterMonth = ['!=', ['string', ['get', 'IgntMonth']], 'placeholder'];

        d3.json(
            // 'rawData/collisions1601.geojson',
            // 'rawData/classD.geojson',
            'data/bothDatesClean.geojson',
            function (err, data) {
                if (err) throw err;

                // Create a year property value based on IgntDate (time)
                // used to filter against.
                data.features = data.features.map(function (d) {
                    d.properties.year = new Date(d.properties.IgntDate)
                        .getFullYear();
                    return d;
                });

                map.addSource('fires', {
                    type: 'geojson',
                    data: data
                });

                console.log(data)

                map.addLayer({
                    id: 'firePolys',
                    type: 'fill',
                    source: 'fires',
                    paint: {
                        'fill-color': [
                            'interpolate',
                            ['linear'],
                            ['number', ['get', 'Acres']],
                            150, '#ffffcc',
                            300, '#ffeda0',
                            750, '#fed976',
                            1000, '#feb24c',
                            50000, '#fd8d3c',
                            75000, '#fc4e2a',
                            150000, '#e31a1c',
                            300000, '#b10026',

                            //  900, '#fd8d3c', // '#FCA107',
                            //  900000, '#b10026', // '#7F3121'
                        ],
                        'fill-opacity': 0.8
                    },
                    filter: ['==', ['number', ['get', 'year']], 2019]
                });


                // SLIDER
                document.getElementById('slider').addEventListener('input', function (e) {
                    var year = parseInt(e.target.value, 10);

                    const fireYears = [1976,
                        1977,
                        1978,
                        1979,
                        1980,
                        1981,
                        1982,
                        1983,
                        1984,
                        1985,
                        1986,
                        1987,
                        1988,
                        1989,
                        1990,
                        1991,
                        1992,
                        1993,
                        1994,
                        1995,
                        1996,
                        1997,
                        1998,
                        1999,
                        2000,
                        2001,
                        2002,
                        2003,
                        2004,
                        2005,
                        2006,
                        2007,
                        2008,
                        2009,
                        2010,
                        2011,
                        2012,
                        2013,
                        2014,
                        2015,
                        2016,
                        2017,
                        2018,
                        2019
                    ];

                    var sliderYear = fireYears[year]

                    //    console.log(sliderYear)

                    // update the map
                    filterYear = ['==', ['number', ['get', 'year']], sliderYear];
                    map.setFilter('firePolys', ['all', filterYear, filterMonth]);

                    // update text in the UI
                    document.getElementById('active-year').innerText = sliderYear;
                });


                // RADIO BUTTONS
                document
                    .getElementById('filters')
                    .addEventListener('change', function (e) {
                        var month = (e.target.value);

                        //    console.log(month)

                        // update the map filter
                        if (month === 'all') {
                            filterMonth = ['!=', ['string', ['get', 'IgntMonth']], 'placeholder'];
                        } else if (month === 'January') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['January'],
                                true,
                                false
                            ];
                        } else if (month === 'February') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['February'],
                                true,
                                false
                            ];
                        } else if (month === 'March') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['March'],
                                true,
                                false
                            ];
                        } else if (month === 'April') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['April'],
                                true,
                                false
                            ];
                        } else if (month === 'May') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['May'],
                                true,
                                false
                            ];
                        } else if (month === 'June') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['June'],
                                true,
                                false
                            ];
                        } else if (month === 'July') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['July'],
                                true,
                                false
                            ];
                        } else if (month === 'August') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['August'],
                                true,
                                false
                            ];
                        } else if (month === 'September') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['September'],
                                true,
                                false
                            ];
                        } else if (month === 'October') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['October'],
                                true,
                                false
                            ];
                        } else if (month === 'November') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['November'],
                                true,
                                false
                            ];
                        } else if (month === 'December') {
                            filterMonth = [
                                'match',
                                ['get', 'IgntMonth'],
                                ['December'],
                                true,
                                false
                            ];
                        } else {
                            console.log('error');
                        }
                        map.setFilter('firePolys', ['all', filterMonth, filterYear]);
                    });

                // When a click event occurs on a feature in the states layer, open a popup at the
                // location of the click, with description HTML from its properties.
                map.on('click', 'firePolys', function (e) {

                    var acresNum = e.features[0].properties.Acres
                    var acresFixed = acresNum.toFixed(2);
                    var ac = acresNum.toLocaleString()


                    // console.log(acresFixed)

                    new mapboxgl.Popup()
                        .setLngLat(e.lngLat)
                        .setHTML(`<b>Fire Name:</b> ${e.features[0].properties.FireName}<br><b>Fire
                        Cause:</b> ${e.features[0].properties.FireCause}<br><b>Fire
                        Size:</b> ${ac} Acres<br><b>Fire Year:</b>
                        ${e.features[0].properties.FireYear}<br><b>Ignition Month:</b>
                        ${e.features[0].properties.IgntMonth}<br><b>Control Month:</b>
                        ${e.features[0].properties.ContrlMonth}`)
                        .addTo(map);
                });

                // Change the cursor to a pointer when the mouse is over the states layer.
                map.on('mouseenter', 'firePolys', function () {
                    map.getCanvas().style.cursor = 'pointer';
                });

                // Change it back to a pointer when it leaves.
                map.on('mouseleave', 'firePolys', function () {
                    map.getCanvas().style.cursor = '';
                });

            });
    });

    $(function(){
    $('a.disabled').on('click',function(event){
    event.preventDefault();
    }).removeClass('disabled');
    });
</script>

</html>